using System;
using System.Collections.Generic;
using System.Windows;

namespace DesktopPlus
{
    public partial class MainWindow : Window
    {
        private static readonly Dictionary<string, Dictionary<string, string>> LocalizationData =
            new Dictionary<string, Dictionary<string, string>>(StringComparer.OrdinalIgnoreCase)
            {
                ["de"] = new Dictionary<string, string>
                {
                    ["Loc.TabGeneral"] = "Allgemein",
                    ["Loc.TabPanels"] = "Panels",
                    ["Loc.TabLayouts"] = "Layouts",
                    ["Loc.TabThemes"] = "Themen",
                    ["Loc.TabAutoSort"] = "Auto-Sort",
                    ["Loc.TabShortcuts"] = "Shortcuts",
                    ["Loc.GeneralTitle"] = "Allgemein",
                    ["Loc.GeneralLanguageLabel"] = "Sprache",
                    ["Loc.LanguageGerman"] = "Deutsch",
                    ["Loc.LanguageEnglish"] = "Englisch",
                    ["Loc.GeneralStartupCheckbox"] = "Mit Windows starten",
                    ["Loc.GeneralCloseLabel"] = "Beim Schließen",
                    ["Loc.CloseBehaviorMinimize"] = "Minimieren",
                    ["Loc.CloseBehaviorExit"] = "Programm beenden",
                    ["Loc.PanelsTitle"] = "Panels",
                    ["Loc.PanelsNew"] = "Neues Panel",
                    ["Loc.PanelsDesc"] = "Übersicht pro Panel.",
                    ["Loc.PanelsHide"] = "Ausblenden",
                    ["Loc.PanelsShow"] = "Einblenden",
                    ["Loc.PanelsShowAll"] = "Alle zeigen",
                    ["Loc.PanelsHideAll"] = "Alle ausblenden",
                    ["Loc.PanelsDelete"] = "Löschen",
                    ["Loc.PanelsSettings"] = "Einstellungen",
                    ["Loc.ContextRevealInExplorer"] = "Im Explorer anzeigen",
                    ["Loc.ContextRemoveFromPanel"] = "Aus Panel entfernen",
                    ["Loc.ContextRename"] = "Umbenennen",
                    ["Loc.ContextCut"] = "Ausschneiden",
                    ["Loc.ContextCopy"] = "Kopieren",
                    ["Loc.ContextPaste"] = "Einfügen",
                    ["Loc.ContextMoreOptions"] = "Weitere Optionen anzeigen",
                    ["Loc.PanelDropHint"] = "Ordner hierher ziehen um Standardordner zu setzen\noder Dateien ablegen",
                    ["Loc.PanelDropHintShort"] = "Dateien oder Ordner hierher ziehen",
                    ["Loc.LayoutsTitle"] = "Layouts",
                    ["Loc.LayoutsCreateFromCurrent"] = "Layout hinzufügen",
                    ["Loc.LayoutsCreateEmpty"] = "Leeres Layout",
                    ["Loc.LayoutsDesc"] = "Layouts speichern sichtbare Panels, Positionen und Theme.",
                    ["Loc.LayoutsApply"] = "Laden",
                    ["Loc.LayoutsUpdate"] = "Aktuelles Layout speichern",
                    ["Loc.LayoutsDelete"] = "Löschen",
                    ["Loc.LayoutsDefaultPreset"] = "Standardpreset",
                    ["Loc.LayoutsGlobalPanelSettings"] = "Globale Panel-Settings",
                    ["Loc.ThemesTitle"] = "Preset-Auswahl",
                    ["Loc.ThemesDesc"] = "Wähle ein Preset oder erstelle ein eigenes.",
                    ["Loc.ThemesPresetTooltip"] = "Neues Preset",
                    ["Loc.ThemesCreate"] = "Erstellen",
                    ["Loc.ThemesApplyAll"] = "Auf alle",
                    ["Loc.ThemesSave"] = "Speichern",
                    ["Loc.ThemesDelete"] = "Löschen",
                    ["Loc.ThemesResetDefaults"] = "Standard-Presets",
                    ["Loc.FineTuneTitle"] = "Feintuning",
                    ["Loc.LabelBackgroundColor"] = "Hintergrundfarbe",
                    ["Loc.LabelHeaderColor"] = "Header-Farbe",
                    ["Loc.LabelOpacity"] = "Deckkraft",
                    ["Loc.LabelAccentColor"] = "Akzentfarbe",
                    ["Loc.TypographyTitle"] = "Typografie",
                    ["Loc.LabelFontFamily"] = "Schriftart",
                    ["Loc.LabelTextColor"] = "Textfarbe",
                    ["Loc.LabelFolderColor"] = "Ordnerfarbe",
                    ["Loc.LabelTabActiveColor"] = "Tabfarbe aktiv",
                    ["Loc.LabelTabInactiveColor"] = "Tabfarbe inaktiv",
                    ["Loc.LabelTabHoverColor"] = "Tabfarbe Hover",
                    ["Loc.LabelTitleSize"] = "Titelgröße",
                    ["Loc.LabelItemSize"] = "Textgröße",
                    ["Loc.LabelCornerRadius"] = "Eckenradius",
                    ["Loc.LabelShadow"] = "Schatten",
                    ["Loc.LabelHeaderShadow"] = "Header",
                    ["Loc.LabelBodyShadow"] = "Body",
                    ["Loc.LabelMode"] = "Modus",
                    ["Loc.ModeSolid"] = "Farbe",
                    ["Loc.ModeImage"] = "Bild",
                    ["Loc.ModePattern"] = "Muster",
                    ["Loc.LabelPattern"] = "Muster",
                    ["Loc.PatternNone"] = "Keine",
                    ["Loc.PatternDiagonal"] = "Diagonal",
                    ["Loc.PatternGrid"] = "Karos",
                    ["Loc.PatternDots"] = "Punkte",
                    ["Loc.PatternCustom"] = "Custom",
                    ["Loc.LabelPatternColor"] = "Pattern-Farbe",
                    ["Loc.LabelPatternOpacity"] = "Pattern-Deckkraft",
                    ["Loc.LabelPatternTileSize"] = "Kachelgröße",
                    ["Loc.LabelPatternStroke"] = "Strichstärke",
                    ["Loc.PatternEditorHint"] = "Links zeichnen, rechts löschen",
                    ["Loc.ButtonPatternClear"] = "Leeren",
                    ["Loc.LabelBackgroundImage"] = "Hintergrundbild",
                    ["Loc.ButtonBrowse"] = "...",
                    ["Loc.OptionGlass"] = "Glass-Effekt",
                    ["Loc.OptionImageFill"] = "Bild füllen",
                    ["Loc.LabelImageGlassIntensity"] = "Bild/Glass Intensität",
                    ["Loc.PreviewTitle"] = "Vorschau",
                    ["Loc.PreviewFolderDocs"] = "Dokumente",
                    ["Loc.PreviewFolderPhotos"] = "Bilder",
                    ["Loc.PreviewFolderProjects"] = "Projekte",
                    ["Loc.PreviewFileReadme"] = "readme.md",
                    ["Loc.PreviewFileTodo"] = "todo.txt",
                    ["Loc.PreviewFileBudget"] = "Budget.xlsx",
                    ["Loc.ShortcutsTitle"] = "Shortcuts",
                    ["Loc.ShortcutsDesc"] = "Übersicht der aktuell verfügbaren Tastatur- und Maus-Shortcuts.",
                    ["Loc.ShortcutsGlobalTitle"] = "Globale Hotkeys",
                    ["Loc.ShortcutsGlobalHint"] = "In Feld klicken und Tastenkombination drücken. Danach mit Anwenden speichern.",
                    ["Loc.ShortcutsExistingTitle"] = "Panel-Shortcuts",
                    ["Loc.ShortcutsInputHide"] = "Panels ein-/ausblenden",
                    ["Loc.ShortcutsInputForeground"] = "Panels in Vordergrund",
                    ["Loc.ShortcutsApply"] = "Anwenden",
                    ["Loc.ShortcutsReset"] = "Standard",
                    ["Loc.ShortcutHideAllPanels"] = "Alle Panels ein-/ausblenden (umschalten).",
                    ["Loc.ShortcutTemporaryForeground"] = "Alle offenen Panels für kurze Zeit vor alle Apps holen.",
                    ["Loc.ShortcutDeleteSelection"] = "Auswahl löschen (Dateien in Papierkorb oder aus Liste entfernen).",
                    ["Loc.ShortcutCopySelection"] = "Auswahl in die Zwischenablage kopieren.",
                    ["Loc.ShortcutCutSelection"] = "Auswahl ausschneiden.",
                    ["Loc.ShortcutPasteSelection"] = "Dateien aus der Zwischenablage einfügen.",
                    ["Loc.ShortcutPanelZoom"] = "Inhalt im Panel vergrößern/verkleinern.",
                    ["Loc.ShortcutAdditiveSelection"] = "Mehrfachauswahl umschalten (additiv).",
                    ["Loc.ShortcutRangeSelection"] = "Bereichsauswahl in der Dateiliste.",
                    ["Loc.ShortcutClassicContextMenu"] = "Klassisches Windows-Kontextmenü im Panel.",
                    ["Loc.ShortcutDragCopy"] = "Beim Drag&Drop Kopieren erzwingen.",
                    ["Loc.ShortcutDragMove"] = "Beim Drag&Drop Verschieben erzwingen.",
                    ["Loc.ShortcutDragLink"] = "Beim Drag&Drop Verknüpfung erstellen.",
                    ["Loc.ShortcutTrayClose"] = "Tray-Menü schließen.",
                    ["Loc.ShortcutFitContent"] = "Panelgröße auf Inhalt anpassen.",
                    ["Loc.MsgShortcutInvalid"] = "Ungültiger Shortcut für \"{0}\". Bitte Kombination mit Ctrl, Alt, Shift oder Win verwenden.",
                    ["Loc.MsgShortcutDuplicate"] = "Beide globalen Shortcuts dürfen nicht identisch sein.",
                    ["Loc.MsgShortcutRegisterFailed"] = "Shortcut \"{0}\" konnte nicht registriert werden. Eventuell wird er bereits von einer anderen App verwendet.",
                    ["Loc.AutoSortTitle"] = "Desktop automatisch aufräumen",
                    ["Loc.AutoSortDesc"] = "Sortiert Desktop-Dateien und Ordner nach Regeln in eigene Ziel-Panels.",
                    ["Loc.AutoSortToggle"] = "Neue Desktop-Elemente immer automatisch einsortieren",
                    ["Loc.AutoSortRunNow"] = "Jetzt sortieren",
                    ["Loc.AutoSortResetRules"] = "Regeln zurücksetzen",
                    ["Loc.AutoSortBuiltInTitle"] = "Standardregeln",
                    ["Loc.AutoSortCustomTitle"] = "Eigene Dateiendungen",
                    ["Loc.AutoSortCustomHint"] = "Beispiel Endungen: .blend .psd .sketch",
                    ["Loc.AutoSortRuleType"] = "Typ",
                    ["Loc.AutoSortRuleExtensions"] = "Dateiendungen",
                    ["Loc.AutoSortRuleTarget"] = "Ziel-Panel",
                    ["Loc.AutoSortCustomExtensionsLabel"] = "Neue Endungen",
                    ["Loc.AutoSortCustomTargetLabel"] = "Ziel-Panel",
                    ["Loc.AutoSortCustomAdd"] = "Regel hinzufügen",
                    ["Loc.AutoSortRemove"] = "Entfernen",
                    ["Loc.AutoSortExtensionsFolders"] = "(Ordner)",
                    ["Loc.AutoSortExtensionsCatchAll"] = "(Alle übrigen Dateien)",
                    ["Loc.AutoSortRuleFolders"] = "Ordner",
                    ["Loc.AutoSortRuleImages"] = "Bilder",
                    ["Loc.AutoSortRuleVideos"] = "Videos",
                    ["Loc.AutoSortRuleAudio"] = "Audio",
                    ["Loc.AutoSortRuleDocuments"] = "Dokumente",
                    ["Loc.AutoSortRuleArchives"] = "Archive",
                    ["Loc.AutoSortRuleInstallers"] = "Installer & Skripte",
                    ["Loc.AutoSortRuleShortcuts"] = "Verknüpfungen",
                    ["Loc.AutoSortRuleCode"] = "Code-Dateien",
                    ["Loc.AutoSortRuleOthers"] = "Sonstiges",
                    ["Loc.AutoSortPanelFolders"] = "Ordner",
                    ["Loc.AutoSortPanelImages"] = "Bilder",
                    ["Loc.AutoSortPanelVideos"] = "Videos",
                    ["Loc.AutoSortPanelAudio"] = "Audio",
                    ["Loc.AutoSortPanelDocuments"] = "Dokumente",
                    ["Loc.AutoSortPanelArchives"] = "Archive",
                    ["Loc.AutoSortPanelInstallers"] = "Installer",
                    ["Loc.AutoSortPanelShortcuts"] = "Verknüpfungen",
                    ["Loc.AutoSortPanelCode"] = "Code",
                    ["Loc.AutoSortPanelOthers"] = "Sonstiges",
                    ["Loc.AutoSortStatusDisabled"] = "Auto-Sort ist deaktiviert.",
                    ["Loc.AutoSortStatusEnabled"] = "Auto-Sort ist aktiv und beobachtet den Desktop.",
                    ["Loc.AutoSortCustomRuleNameFormat"] = "Custom ({0})",
                    ["Loc.AutoSortMsgInvalidExtensions"] = "Bitte mindestens eine gültige Dateiendung angeben (z.B. .psd .blend).",
                    ["Loc.AutoSortMsgRuleAdded"] = "Neue Regel wurde hinzugefügt.",
                    ["Loc.AutoSortMsgRuleRemoved"] = "Regel wurde entfernt.",
                    ["Loc.AutoSortMsgSortDone"] = "{0} Desktop-Element(e) wurden einsortiert.",
                    ["Loc.AutoSortMsgSortDoneWithErrors"] = "{0} Element(e) einsortiert, {1} konnten nicht verschoben werden.",
                    ["Loc.AutoSortMsgSortNoItems"] = "Keine neuen Desktop-Elemente zum Einsortieren gefunden.",
                    ["Loc.AutoSortMsgSortFailed"] = "Automatisches Sortieren fehlgeschlagen:\n{0}",
                    ["Loc.PanelStateOpen"] = "Offen",
                    ["Loc.PanelStateCollapsed"] = "Eingeklappt",
                    ["Loc.PanelStateHidden"] = "Ausgeblendet",
                    ["Loc.PanelStateClosed"] = "Geschlossen",
                    ["Loc.PanelTypeList"] = "Liste ({0})",
                    ["Loc.PanelTypeFolder"] = "Ordner",
                    ["Loc.PanelTypeFile"] = "Datei",
                    ["Loc.PanelActionShow"] = "Anzeigen",
                    ["Loc.PanelActionReveal"] = "Einblenden",
                    ["Loc.PanelCount"] = "{0} Panels",
                    ["Loc.PanelCountHidden"] = "{0} Panels, {1} ausgeblendet",
                    ["Loc.LayoutCount"] = "{0} Layouts",
                    ["Loc.LayoutSummaryEmpty"] = "Leer",
                    ["Loc.LayoutSummaryVisibleHidden"] = "{0} sichtbar, {1} ausgeblendet",
                    ["Loc.LayoutSummaryTheme"] = "Theme",
                    ["Loc.Untitled"] = "Unbenannt",
                    ["Loc.NoFolder"] = "(kein Ordner)",
                    ["Loc.PanelWindowTitle"] = "Panel",
                    ["Loc.PanelDefaultTitle"] = "Panel",
                    ["Loc.PanelMoveTooltip"] = "Fenster verschieben",
                    ["Loc.PanelSettingsTooltip"] = "Panel-Einstellungen",
                    ["Loc.PanelSearchPlaceholder"] = "Suchen...",
                    ["Loc.PanelCollapseTooltip"] = "Inhalt ein-/ausklappen",
                    ["Loc.PanelCloseTooltip"] = "Schließen",
                    ["Loc.PanelSettingsTitle"] = "Panel-Einstellungen",
                    ["Loc.PanelSettingsName"] = "Name",
                    ["Loc.PanelSettingsPreset"] = "Preset",
                    ["Loc.PanelSettingsDefaultFolder"] = "Standardordner",
                    ["Loc.PanelSettingsFolderUnset"] = "(nicht gesetzt)",
                    ["Loc.PanelSettingsChange"] = "Ändern",
                    ["Loc.PanelSettingsFolderAction"] = "Ordner-Aktion",
                    ["Loc.PanelSettingsOpenInternal"] = "Im Panel navigieren",
                    ["Loc.PanelSettingsOpenExternal"] = "Im Explorer öffnen",
                    ["Loc.PanelSettingsExpandOnHover"] = "Beim Hover aufklappen",
                    ["Loc.PanelSettingsShowHidden"] = "Versteckte Elemente anzeigen",
                    ["Loc.PanelSettingsShowParentFolder"] = "Überordner anzeigen",
                    ["Loc.PanelSettingsShowFileExtensions"] = "Dateiendungen anzeigen",
                    ["Loc.PanelSettingsShowSettingsButton"] = "Einstellungsbutton anzeigen",
                    ["Loc.PanelSettingsActions"] = "Aktionen",
                    ["Loc.PanelSettingsViewMode"] = "Ansicht",
                    ["Loc.PanelSettingsViewIcons"] = "Kachelansicht",
                    ["Loc.PanelSettingsViewDetails"] = "Listenansicht",
                    ["Loc.PanelSettingsViewPhotos"] = "Fotoalbum",
                    ["Loc.PanelSettingsMetadata"] = "Metadaten",
                    ["Loc.PanelSettingsMetadataDragHint"] = "Reihenfolge per Drag and Drop ändern.",
                    ["Loc.PanelSettingsMetaType"] = "Dateityp",
                    ["Loc.PanelSettingsMetaSize"] = "Dateigröße",
                    ["Loc.PanelSettingsMetaCreated"] = "Erstellt am",
                    ["Loc.PanelSettingsMetaModified"] = "Geändert am",
                    ["Loc.PanelSettingsMetaDimensions"] = "Bildgröße",
                    ["Loc.PanelSettingsMovement"] = "Bewegung",
                    ["Loc.PanelSettingsSearchVisibility"] = "Suche",
                    ["Loc.PanelSettingsSearchAlways"] = "Immer anzeigen",
                    ["Loc.PanelSettingsSearchExpandedOnly"] = "Nur ausgeklappt",
                    ["Loc.PanelSettingsSearchHidden"] = "Ausblenden",
                    ["Loc.PanelSettingsGlobalHint"] = "Gilt als Standard im Layout. Bereits abweichende Panel-Werte bleiben unverändert.",
                    ["Loc.MovementTitlebar"] = "Titelleiste ziehen",
                    ["Loc.MovementButton"] = "Move-Button",
                    ["Loc.MovementLocked"] = "Gesperrt",
                    ["Loc.PanelSettingsFitContent"] = "An Inhalt anpassen",
                    ["Loc.PanelSettingsCancel"] = "Abbrechen",
                    ["Loc.PanelSettingsResetToStandard"] = "Auf Standard zurücksetzen",
                    ["Loc.PanelSettingsSave"] = "Speichern",
                    ["Loc.TabNewTab"] = "Neuer Tab",
                    ["Loc.TabClose"] = "Tab schließen",
                    ["Loc.TabCloseOthers"] = "Andere Tabs schließen",
                    ["Loc.TabRename"] = "Tab umbenennen",
                    ["Loc.TabDropPreview"] = "+ Neuer Tab",
                    ["Loc.InputDialogTitle"] = "Eingabe",
                    ["Loc.InputDialogOk"] = "OK",
                    ["Loc.InputDialogCancel"] = "Abbrechen",
                    ["Loc.TrayOpen"] = "Öffnen",
                    ["Loc.TrayExit"] = "Beenden",
                    ["Loc.TrayStatusRunning"] = "Im Hintergrund aktiv",
                    ["Loc.TrayHintEsc"] = "Esc schließt dieses Menü",
                    ["Loc.MsgError"] = "Fehler",
                    ["Loc.MsgInfo"] = "Hinweis",
                    ["Loc.MsgPresetNameRequired"] = "Bitte einen Preset-Namen eingeben.",
                    ["Loc.MsgPresetBuiltIn"] = "Ein eingebautes Preset kann nicht überschrieben werden. Wähle einen anderen Namen.",
                    ["Loc.MsgPresetBuiltInDelete"] = "Eingebaute Presets können nicht gelöscht werden.",
                    ["Loc.MsgPresetNameExists"] = "Ein Preset mit diesem Namen existiert bereits.",
                    ["Loc.MsgPresetReset"] = "Standard-Presets wurden zurückgesetzt.",
                    ["Loc.MsgResetConfirmTitle"] = "Zurücksetzen bestätigen",
                    ["Loc.MsgResetConfirmMessage"] = "Möchten Sie wirklich alle Standard-Presets zurücksetzen?\n\nDiese Aktion kann nicht rückgängig gemacht werden.",
                    ["Loc.ThemesResetDefaultsFull"] = "Standard-Presets zurücksetzen",
                    ["Loc.MsgRestoreError"] = "Fehler beim Wiederherstellen der Fenster:\n{0}",
                    ["Loc.MsgSaveError"] = "Fehler beim Speichern der Fenster:\n{0}",
                    ["Loc.MsgMoveFolderError"] = "Ordner konnte nicht verschoben werden:\n{0}",
                    ["Loc.MsgMoveFileError"] = "Datei konnte nicht verschoben werden:\n{0}",
                    ["Loc.MsgRenameError"] = "Umbenennen fehlgeschlagen:\n{0}",
                    ["Loc.MsgOpenFolderError"] = "Fehler beim Öffnen des Ordners:\n{0}",
                    ["Loc.MsgOpenFileError"] = "Fehler beim Öffnen der Datei:\n{0}",
                    ["Loc.MsgDeleteConfirmTitle"] = "Löschen bestätigen",
                    ["Loc.MsgDeleteRecycleSingle"] = "Soll \"{0}\" in den Papierkorb verschoben werden?",
                    ["Loc.MsgDeleteRecycleMulti"] = "Sollen {0} Elemente in den Papierkorb verschoben werden?",
                    ["Loc.MsgDeletePanelOnlySingle"] = "Soll \"{0}\" aus diesem Panel entfernt werden?",
                    ["Loc.MsgDeletePanelOnlyMulti"] = "Sollen {0} Elemente aus diesem Panel entfernt werden?",
                    ["Loc.MsgDeletePathError"] = "Element konnte nicht in den Papierkorb verschoben werden:\n{0}",
                    ["Loc.MsgStartupError"] = "Autostart konnte nicht aktualisiert werden:\n{0}",
                    ["Loc.PromptLayoutName"] = "Layout-Name",
                    ["Loc.PromptPanelName"] = "Panel-Name",
                    ["Loc.PromptPresetName"] = "Preset-Name",
                    ["Loc.ThemesPresetDefaultName"] = "Neues Preset"
                },
                ["en"] = new Dictionary<string, string>
                {
                    ["Loc.TabGeneral"] = "General",
                    ["Loc.TabPanels"] = "Panels",
                    ["Loc.TabLayouts"] = "Layouts",
                    ["Loc.TabThemes"] = "Themes",
                    ["Loc.TabAutoSort"] = "Auto sort",
                    ["Loc.TabShortcuts"] = "Shortcuts",
                    ["Loc.GeneralTitle"] = "General",
                    ["Loc.GeneralLanguageLabel"] = "Language",
                    ["Loc.LanguageGerman"] = "German",
                    ["Loc.LanguageEnglish"] = "English",
                    ["Loc.GeneralStartupCheckbox"] = "Start with Windows",
                    ["Loc.GeneralCloseLabel"] = "On close",
                    ["Loc.CloseBehaviorMinimize"] = "Minimize",
                    ["Loc.CloseBehaviorExit"] = "Exit application",
                    ["Loc.PanelsTitle"] = "Panels",
                    ["Loc.PanelsNew"] = "New panel",
                    ["Loc.PanelsDesc"] = "Overview per panel.",
                    ["Loc.PanelsHide"] = "Hide",
                    ["Loc.PanelsShow"] = "Show",
                    ["Loc.PanelsShowAll"] = "Show all",
                    ["Loc.PanelsHideAll"] = "Hide all",
                    ["Loc.PanelsDelete"] = "Delete",
                    ["Loc.PanelsSettings"] = "Settings",
                    ["Loc.ContextRevealInExplorer"] = "Reveal in Explorer",
                    ["Loc.ContextRemoveFromPanel"] = "Remove from panel",
                    ["Loc.ContextRename"] = "Rename",
                    ["Loc.ContextCut"] = "Cut",
                    ["Loc.ContextCopy"] = "Copy",
                    ["Loc.ContextPaste"] = "Paste",
                    ["Loc.ContextMoreOptions"] = "Show more options",
                    ["Loc.PanelDropHint"] = "Drop a folder here to set as default\nor drop individual files",
                    ["Loc.PanelDropHintShort"] = "Drop files or folders here",
                    ["Loc.LayoutsTitle"] = "Layouts",
                    ["Loc.LayoutsCreateFromCurrent"] = "Add layout",
                    ["Loc.LayoutsCreateEmpty"] = "Add empty",
                    ["Loc.LayoutsDesc"] = "Layouts store visible panels, positions, and theme.",
                    ["Loc.LayoutsApply"] = "Load",
                    ["Loc.LayoutsUpdate"] = "Save current layout",
                    ["Loc.LayoutsDelete"] = "Delete",
                    ["Loc.LayoutsDefaultPreset"] = "Standard preset",
                    ["Loc.LayoutsGlobalPanelSettings"] = "Global panel settings",
                    ["Loc.ThemesTitle"] = "Preset selection",
                    ["Loc.ThemesDesc"] = "Choose a preset or create your own.",
                    ["Loc.ThemesPresetTooltip"] = "New preset",
                    ["Loc.ThemesCreate"] = "Create",
                    ["Loc.ThemesApplyAll"] = "Apply to all",
                    ["Loc.ThemesSave"] = "Save",
                    ["Loc.ThemesDelete"] = "Delete",
                    ["Loc.ThemesResetDefaults"] = "Reset defaults",
                    ["Loc.FineTuneTitle"] = "Fine tune",
                    ["Loc.LabelBackgroundColor"] = "Background color",
                    ["Loc.LabelHeaderColor"] = "Header color",
                    ["Loc.LabelOpacity"] = "Opacity",
                    ["Loc.LabelAccentColor"] = "Accent color",
                    ["Loc.TypographyTitle"] = "Typography",
                    ["Loc.LabelFontFamily"] = "Font",
                    ["Loc.LabelTextColor"] = "Text color",
                    ["Loc.LabelFolderColor"] = "Folder color",
                    ["Loc.LabelTabActiveColor"] = "Tab color active",
                    ["Loc.LabelTabInactiveColor"] = "Tab color inactive",
                    ["Loc.LabelTabHoverColor"] = "Tab color hover",
                    ["Loc.LabelTitleSize"] = "Title size",
                    ["Loc.LabelItemSize"] = "Item size",
                    ["Loc.LabelCornerRadius"] = "Corner radius",
                    ["Loc.LabelShadow"] = "Shadow",
                    ["Loc.LabelHeaderShadow"] = "Header",
                    ["Loc.LabelBodyShadow"] = "Body",
                    ["Loc.LabelMode"] = "Mode",
                    ["Loc.ModeSolid"] = "Solid",
                    ["Loc.ModeImage"] = "Image",
                    ["Loc.ModePattern"] = "Pattern",
                    ["Loc.LabelPattern"] = "Pattern",
                    ["Loc.PatternNone"] = "None",
                    ["Loc.PatternDiagonal"] = "Diagonal",
                    ["Loc.PatternGrid"] = "Grid",
                    ["Loc.PatternDots"] = "Dots",
                    ["Loc.PatternCustom"] = "Custom",
                    ["Loc.LabelPatternColor"] = "Pattern color",
                    ["Loc.LabelPatternOpacity"] = "Pattern opacity",
                    ["Loc.LabelPatternTileSize"] = "Tile size",
                    ["Loc.LabelPatternStroke"] = "Stroke width",
                    ["Loc.PatternEditorHint"] = "Left draw, right erase",
                    ["Loc.ButtonPatternClear"] = "Clear",
                    ["Loc.LabelBackgroundImage"] = "Background image",
                    ["Loc.ButtonBrowse"] = "...",
                    ["Loc.OptionGlass"] = "Glass effect",
                    ["Loc.OptionImageFill"] = "Fill image",
                    ["Loc.LabelImageGlassIntensity"] = "Image/Glass intensity",
                    ["Loc.PreviewTitle"] = "Preview",
                    ["Loc.PreviewFolderDocs"] = "Documents",
                    ["Loc.PreviewFolderPhotos"] = "Pictures",
                    ["Loc.PreviewFolderProjects"] = "Projects",
                    ["Loc.PreviewFileReadme"] = "readme.md",
                    ["Loc.PreviewFileTodo"] = "todo.txt",
                    ["Loc.PreviewFileBudget"] = "Budget.xlsx",
                    ["Loc.ShortcutsTitle"] = "Shortcuts",
                    ["Loc.ShortcutsDesc"] = "Overview of currently available keyboard and mouse shortcuts.",
                    ["Loc.ShortcutsGlobalTitle"] = "Global hotkeys",
                    ["Loc.ShortcutsGlobalHint"] = "Click a field and press a key combination, then save with Apply.",
                    ["Loc.ShortcutsExistingTitle"] = "Panel shortcuts",
                    ["Loc.ShortcutsInputHide"] = "Toggle panels",
                    ["Loc.ShortcutsInputForeground"] = "Bring panels forward",
                    ["Loc.ShortcutsApply"] = "Apply",
                    ["Loc.ShortcutsReset"] = "Default",
                    ["Loc.ShortcutHideAllPanels"] = "Toggle all panels (show/hide).",
                    ["Loc.ShortcutTemporaryForeground"] = "Bring all open panels to the front temporarily.",
                    ["Loc.ShortcutDeleteSelection"] = "Delete selection (recycle files or remove from list).",
                    ["Loc.ShortcutCopySelection"] = "Copy selection to the clipboard.",
                    ["Loc.ShortcutCutSelection"] = "Cut selection.",
                    ["Loc.ShortcutPasteSelection"] = "Paste files from the clipboard.",
                    ["Loc.ShortcutPanelZoom"] = "Zoom panel content in or out.",
                    ["Loc.ShortcutAdditiveSelection"] = "Toggle additive multi-selection.",
                    ["Loc.ShortcutRangeSelection"] = "Range selection in the file list.",
                    ["Loc.ShortcutClassicContextMenu"] = "Open the classic Windows context menu in a panel.",
                    ["Loc.ShortcutDragCopy"] = "Force copy while drag and drop.",
                    ["Loc.ShortcutDragMove"] = "Force move while drag and drop.",
                    ["Loc.ShortcutDragLink"] = "Create link while drag and drop.",
                    ["Loc.ShortcutTrayClose"] = "Close the tray menu.",
                    ["Loc.ShortcutFitContent"] = "Fit panel size to content.",
                    ["Loc.MsgShortcutInvalid"] = "Invalid shortcut for \"{0}\". Use a combination with Ctrl, Alt, Shift, or Win.",
                    ["Loc.MsgShortcutDuplicate"] = "The two global shortcuts cannot be identical.",
                    ["Loc.MsgShortcutRegisterFailed"] = "Shortcut \"{0}\" could not be registered. It may already be used by another app.",
                    ["Loc.AutoSortTitle"] = "Automatic desktop cleanup",
                    ["Loc.AutoSortDesc"] = "Sort desktop files and folders by rules into dedicated target panels.",
                    ["Loc.AutoSortToggle"] = "Always auto-sort new desktop items",
                    ["Loc.AutoSortRunNow"] = "Sort now",
                    ["Loc.AutoSortResetRules"] = "Reset rules",
                    ["Loc.AutoSortBuiltInTitle"] = "Built-in rules",
                    ["Loc.AutoSortCustomTitle"] = "Custom extensions",
                    ["Loc.AutoSortCustomHint"] = "Example extensions: .blend .psd .sketch",
                    ["Loc.AutoSortRuleType"] = "Type",
                    ["Loc.AutoSortRuleExtensions"] = "Extensions",
                    ["Loc.AutoSortRuleTarget"] = "Target panel",
                    ["Loc.AutoSortCustomExtensionsLabel"] = "New extensions",
                    ["Loc.AutoSortCustomTargetLabel"] = "Target panel",
                    ["Loc.AutoSortCustomAdd"] = "Add rule",
                    ["Loc.AutoSortRemove"] = "Remove",
                    ["Loc.AutoSortExtensionsFolders"] = "(Folders)",
                    ["Loc.AutoSortExtensionsCatchAll"] = "(All remaining files)",
                    ["Loc.AutoSortRuleFolders"] = "Folders",
                    ["Loc.AutoSortRuleImages"] = "Images",
                    ["Loc.AutoSortRuleVideos"] = "Videos",
                    ["Loc.AutoSortRuleAudio"] = "Audio",
                    ["Loc.AutoSortRuleDocuments"] = "Documents",
                    ["Loc.AutoSortRuleArchives"] = "Archives",
                    ["Loc.AutoSortRuleInstallers"] = "Installers & scripts",
                    ["Loc.AutoSortRuleShortcuts"] = "Shortcuts",
                    ["Loc.AutoSortRuleCode"] = "Code files",
                    ["Loc.AutoSortRuleOthers"] = "Others",
                    ["Loc.AutoSortPanelFolders"] = "Folders",
                    ["Loc.AutoSortPanelImages"] = "Images",
                    ["Loc.AutoSortPanelVideos"] = "Videos",
                    ["Loc.AutoSortPanelAudio"] = "Audio",
                    ["Loc.AutoSortPanelDocuments"] = "Documents",
                    ["Loc.AutoSortPanelArchives"] = "Archives",
                    ["Loc.AutoSortPanelInstallers"] = "Installers",
                    ["Loc.AutoSortPanelShortcuts"] = "Shortcuts",
                    ["Loc.AutoSortPanelCode"] = "Code",
                    ["Loc.AutoSortPanelOthers"] = "Others",
                    ["Loc.AutoSortStatusDisabled"] = "Auto sort is disabled.",
                    ["Loc.AutoSortStatusEnabled"] = "Auto sort is active and watching your desktop.",
                    ["Loc.AutoSortCustomRuleNameFormat"] = "Custom ({0})",
                    ["Loc.AutoSortMsgInvalidExtensions"] = "Please provide at least one valid extension (for example .psd .blend).",
                    ["Loc.AutoSortMsgRuleAdded"] = "New rule added.",
                    ["Loc.AutoSortMsgRuleRemoved"] = "Rule removed.",
                    ["Loc.AutoSortMsgSortDone"] = "{0} desktop item(s) were sorted.",
                    ["Loc.AutoSortMsgSortDoneWithErrors"] = "{0} item(s) sorted, {1} could not be moved.",
                    ["Loc.AutoSortMsgSortNoItems"] = "No new desktop items found to sort.",
                    ["Loc.AutoSortMsgSortFailed"] = "Automatic sorting failed:\n{0}",
                    ["Loc.PanelStateOpen"] = "Open",
                    ["Loc.PanelStateCollapsed"] = "Collapsed",
                    ["Loc.PanelStateHidden"] = "Hidden",
                    ["Loc.PanelStateClosed"] = "Closed",
                    ["Loc.PanelTypeList"] = "List ({0})",
                    ["Loc.PanelTypeFolder"] = "Folder",
                    ["Loc.PanelTypeFile"] = "File",
                    ["Loc.PanelActionShow"] = "Show",
                    ["Loc.PanelActionReveal"] = "Reveal",
                    ["Loc.PanelCount"] = "{0} panels",
                    ["Loc.PanelCountHidden"] = "{0} panels, {1} hidden",
                    ["Loc.LayoutCount"] = "{0} layouts",
                    ["Loc.LayoutSummaryEmpty"] = "Empty",
                    ["Loc.LayoutSummaryVisibleHidden"] = "{0} visible, {1} hidden",
                    ["Loc.LayoutSummaryTheme"] = "Theme",
                    ["Loc.Untitled"] = "Untitled",
                    ["Loc.NoFolder"] = "(no folder)",
                    ["Loc.PanelWindowTitle"] = "Panel",
                    ["Loc.PanelDefaultTitle"] = "Panel",
                    ["Loc.PanelMoveTooltip"] = "Move window",
                    ["Loc.PanelSettingsTooltip"] = "Panel settings",
                    ["Loc.PanelSearchPlaceholder"] = "Search...",
                    ["Loc.PanelCollapseTooltip"] = "Collapse/expand content",
                    ["Loc.PanelCloseTooltip"] = "Close",
                    ["Loc.PanelSettingsTitle"] = "Panel settings",
                    ["Loc.PanelSettingsName"] = "Name",
                    ["Loc.PanelSettingsPreset"] = "Preset",
                    ["Loc.PanelSettingsDefaultFolder"] = "Default folder",
                    ["Loc.PanelSettingsFolderUnset"] = "(not set)",
                    ["Loc.PanelSettingsChange"] = "Change",
                    ["Loc.PanelSettingsFolderAction"] = "Folder action",
                    ["Loc.PanelSettingsOpenInternal"] = "Navigate in panel",
                    ["Loc.PanelSettingsOpenExternal"] = "Open in Explorer",
                    ["Loc.PanelSettingsExpandOnHover"] = "Expand on hover",
                    ["Loc.PanelSettingsShowHidden"] = "Show hidden items",
                    ["Loc.PanelSettingsShowParentFolder"] = "Show parent folder item",
                    ["Loc.PanelSettingsShowFileExtensions"] = "Show file extensions",
                    ["Loc.PanelSettingsShowSettingsButton"] = "Show settings button",
                    ["Loc.PanelSettingsActions"] = "Actions",
                    ["Loc.PanelSettingsViewMode"] = "View mode",
                    ["Loc.PanelSettingsViewIcons"] = "Tiles",
                    ["Loc.PanelSettingsViewDetails"] = "List details",
                    ["Loc.PanelSettingsViewPhotos"] = "Photo album",
                    ["Loc.PanelSettingsMetadata"] = "Metadata",
                    ["Loc.PanelSettingsMetadataDragHint"] = "Change order via drag and drop.",
                    ["Loc.PanelSettingsMetaType"] = "File type",
                    ["Loc.PanelSettingsMetaSize"] = "File size",
                    ["Loc.PanelSettingsMetaCreated"] = "Created",
                    ["Loc.PanelSettingsMetaModified"] = "Modified",
                    ["Loc.PanelSettingsMetaDimensions"] = "Image size",
                    ["Loc.PanelSettingsMovement"] = "Movement",
                    ["Loc.PanelSettingsSearchVisibility"] = "Search",
                    ["Loc.PanelSettingsSearchAlways"] = "Always show",
                    ["Loc.PanelSettingsSearchExpandedOnly"] = "Only when expanded",
                    ["Loc.PanelSettingsSearchHidden"] = "Hide",
                    ["Loc.PanelSettingsGlobalHint"] = "Used as layout default. Panels with custom values are kept unchanged.",
                    ["Loc.MovementTitlebar"] = "Drag title bar",
                    ["Loc.MovementButton"] = "Move button",
                    ["Loc.MovementLocked"] = "Locked",
                    ["Loc.PanelSettingsFitContent"] = "Fit to content",
                    ["Loc.PanelSettingsCancel"] = "Cancel",
                    ["Loc.PanelSettingsResetToStandard"] = "Reset to standard",
                    ["Loc.PanelSettingsSave"] = "Save",
                    ["Loc.TabNewTab"] = "New Tab",
                    ["Loc.TabClose"] = "Close tab",
                    ["Loc.TabCloseOthers"] = "Close other tabs",
                    ["Loc.TabRename"] = "Rename tab",
                    ["Loc.TabDropPreview"] = "+ New Tab",
                    ["Loc.InputDialogTitle"] = "Input",
                    ["Loc.InputDialogOk"] = "OK",
                    ["Loc.InputDialogCancel"] = "Cancel",
                    ["Loc.TrayOpen"] = "Open",
                    ["Loc.TrayExit"] = "Exit",
                    ["Loc.TrayStatusRunning"] = "Running in the background",
                    ["Loc.TrayHintEsc"] = "Press Esc to close this menu",
                    ["Loc.MsgError"] = "Error",
                    ["Loc.MsgInfo"] = "Info",
                    ["Loc.MsgPresetNameRequired"] = "Please enter a preset name.",
                    ["Loc.MsgPresetBuiltIn"] = "Built-in presets cannot be overwritten. Choose a different name.",
                    ["Loc.MsgPresetBuiltInDelete"] = "Built-in presets cannot be deleted.",
                    ["Loc.MsgPresetNameExists"] = "A preset with this name already exists.",
                    ["Loc.MsgPresetReset"] = "Default presets have been reset.",
                    ["Loc.MsgResetConfirmTitle"] = "Confirm reset",
                    ["Loc.MsgResetConfirmMessage"] = "Are you sure you want to reset all default presets?\n\nThis action cannot be undone.",
                    ["Loc.ThemesResetDefaultsFull"] = "Reset default presets",
                    ["Loc.MsgRestoreError"] = "Error restoring windows:\n{0}",
                    ["Loc.MsgSaveError"] = "Error saving windows:\n{0}",
                    ["Loc.MsgMoveFolderError"] = "Folder could not be moved:\n{0}",
                    ["Loc.MsgMoveFileError"] = "File could not be moved:\n{0}",
                    ["Loc.MsgRenameError"] = "Rename failed:\n{0}",
                    ["Loc.MsgOpenFolderError"] = "Error opening folder:\n{0}",
                    ["Loc.MsgOpenFileError"] = "Error opening file:\n{0}",
                    ["Loc.MsgDeleteConfirmTitle"] = "Confirm delete",
                    ["Loc.MsgDeleteRecycleSingle"] = "Move \"{0}\" to the Recycle Bin?",
                    ["Loc.MsgDeleteRecycleMulti"] = "Move {0} items to the Recycle Bin?",
                    ["Loc.MsgDeletePanelOnlySingle"] = "Remove \"{0}\" from this panel only?",
                    ["Loc.MsgDeletePanelOnlyMulti"] = "Remove {0} items from this panel only?",
                    ["Loc.MsgDeletePathError"] = "Could not move item to the Recycle Bin:\n{0}",
                    ["Loc.MsgStartupError"] = "Autostart could not be updated:\n{0}",
                    ["Loc.PromptLayoutName"] = "Layout name",
                    ["Loc.PromptPanelName"] = "Panel name",
                    ["Loc.PromptPresetName"] = "Preset name",
                    ["Loc.ThemesPresetDefaultName"] = "New preset"
                }
            };

        private void ApplyLanguage(string? code)
        {
            string normalized = string.IsNullOrWhiteSpace(code) ? DefaultLanguageCode : code.Trim();
            if (!LocalizationData.ContainsKey(normalized))
            {
                normalized = DefaultLanguageCode;
            }

            CurrentLanguageCode = normalized;
            if (System.Windows.Application.Current?.Resources != null &&
                LocalizationData.TryGetValue(normalized, out var values))
            {
                foreach (var pair in values)
                {
                    System.Windows.Application.Current.Resources[pair.Key] = pair.Value;
                }
            }

            UpdateNotifyIconMenu();
        }

        public static string GetString(string key)
        {
            if (System.Windows.Application.Current?.Resources != null &&
                System.Windows.Application.Current.Resources.Contains(key))
            {
                return System.Windows.Application.Current.Resources[key]?.ToString() ?? key;
            }

            if (LocalizationData.TryGetValue(CurrentLanguageCode, out var values) &&
                values.TryGetValue(key, out var value))
            {
                return value;
            }

            return key;
        }
    }
}
